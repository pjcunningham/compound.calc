# 🧮 Compound Angle Calculator – Product Requirements Document (PRD)

## Overview
This project defines a **Single Page Application (SPA)** built in **React + MUI (Material UI)** that calculates and visualizes **compound mitre and bevel angles** for woodworking and joinery projects — such as a **Butler’s Tray** or other angled box constructions.

The app should:
- Let users **input the slope angle (S)** in degrees (the lean of a wall from vertical).
- Compute and display the corresponding **Mitre (M)** and **Bevel (B)** angles.
- Generate an **annotated diagram** showing the geometry and saw setup.
- Allow users to **download a PDF report** containing the results and diagrams.
- Be **fully responsive** and visually polished for mobile, tablet, and desktop.

---

## 🎯 Goals
- Provide a **practical tool** for woodworkers to find accurate mitre and bevel settings for given slopes.
- Make the geometry **intuitive and visual**, not just numeric.
- Allow easy **PDF export** for workshop reference.
- Deliver a clean, mobile-friendly interface.

---

## 🔢 Inputs and Outputs

### Input
| Field | Description | Type | Range | Default |
|-------|--------------|------|--------|----------|
| `Slope (S)` | The wall slope measured from vertical | Number (degrees) | 0°–45° | 18° |

### Computed Outputs
| Field | Formula | Description |
|-------|----------|-------------|
| `Mitre (M)` | `M = atan( sin(C/2) / tan(S) )` | Saw turntable rotation |
| `Bevel (B)` | `B = asin( cos(C/2) * cos(S) )` | Saw blade tilt |

**Constants:**
- `C = 90°` (corner angle for rectangular tray)

### Example Output
For S = 18°:
- Mitre = **65.4°**
- Bevel = **42.4°**

---

## 🧠 Functional Requirements

### 1. Calculator Logic
- Implement trigonometric calculations using JavaScript’s `Math` library.
- All angles must round to one decimal place.
- Automatically update output values as the user changes `Slope (S)`.

### 2. Diagram Generation
- Generate **two annotated diagrams** dynamically (SVG preferred):
    1. **Geometry View** – shows wall slope vs. vertical.
    2. **Saw Setup View** – shows blade tilt and mitre rotation.
- Label all relevant angles (S, M, B).
- Use color coding (e.g., red for bevel, blue for mitre).

### 3. PDF Export
- Generate a downloadable PDF that includes:
    - Input and calculated values.
    - The two diagrams (embedded as vector graphics or images).
    - The formulas used and a short explanation.
- Use **jsPDF** + **html2canvas**.

### 4. Responsiveness
- Must use a **mobile-first layout**:
    - On mobile: stacked layout (inputs → results → diagrams → PDF button).
    - On desktop: two-column layout (inputs on left, diagrams/results on right).
- Use **MUI Grid / Flexbox**.
- Fonts and colors should be clear in daylight (workshop-friendly theme).

### 5. UI / UX Features
- **Live updating** results as user drags or types slope angle.
- **Input slider** (0–45°) and **numeric input box** synchronized.
- **Clear layout** with labeled sections:
    - “Input”
    - “Calculated Angles”
    - “Visual Diagram”
    - “Download PDF”

---

## 🧩 Technical Requirements

| Feature | Implementation |
|----------|----------------|
| Framework | React (Vite SPA) |
| Component Library | MUI (Material UI) |
| State management | React hooks |
| Math precision | Floating-point with rounding to 0.1° |
| PDF generation | jsPDF + html2canvas |
| Styling | MUI theme overrides + CSS grid |
| Responsiveness | MUI Grid + Flexbox |
| Accessibility | High-contrast colors, ARIA labels |
| Browser support | Chrome, Edge, Safari, Firefox (last 2 versions) |
| File export | jsPDF (downloadable) |

---

## 🧾 Example PDF Layout

**Header:** Compound Mitre Calculator – Results  
**Content:**
- Input: `Slope (S) = 18°`
- Computed:
    - `Mitre (M) = 65.4°`
    - `Bevel (B) = 42.4°`
- Formula summary
- Two annotated diagrams (geometry + saw setup)
- Footer: "Generated by Compound Angle Calculator"

---

## 🧮 Validation Rules
- Reject slopes outside 0°–45° with a tooltip warning.
- Round displayed results to one decimal place.
- PDF file name format:  
  `compound_angle_Sxx.pdf` (e.g., `compound_angle_S18.pdf`)

---

## 📱 Layout Wireframe (Textual)

```
[ Header: Compound Angle Calculator ]

[ Input Slider + Numeric Box  (Slope S°) ]

[ Results ]
    Mitre (M): 65.4°
    Bevel (B): 42.4°

[ Diagram Tabs ]
    [ Geometry View ] [ Saw Setup View ]

[ Download PDF Button ]
```

---

# 🚀 Build Notes & Starter Setup (React + MUI, pnpm)

**PRD location:** `/.docs/PRD.md`  
**Package manager:** pnpm

---

## 1) Project Setup (in existing directory)

```bash
# Run in current working directory (CWD)
pnpm init
pnpm add react react-dom
pnpm add @mui/material @mui/icons-material @emotion/react @emotion/styled
pnpm add jspdf html2canvas
pnpm add -D vite vite-plugin-svgr eslint prettier eslint-config-prettier eslint-plugin-react
```

Update `package.json` scripts:

```json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "lint": "eslint --ext .js,.jsx src",
    "format": "prettier -w ."
  }
}
```

---

## 2) Folder Structure

```
project-root/
├─ .docs/
│  └─ PRD.md                     # ← this document
├─ src/
│  ├─ app/
│  │  ├─ App.jsx
│  │  ├─ theme.js
│  │  └─ main.jsx
│  ├─ components/
│  │  ├─ ControlsPanel.jsx
│  │  ├─ ResultsCard.jsx
│  │  ├─ DiagramTabs.jsx
│  │  ├─ DiagramGeometry.jsx
│  │  ├─ DiagramSaw.jsx
│  │  └─ PdfButton.jsx
│  ├─ hooks/
│  │  └─ useCalculator.js
│  ├─ utils/
│  │  └─ math.js
│  └─ styles/
│     └─ global.css
└─ package.json
```

---

## 3) Theming & Design (MUI)

Use a workshop-friendly theme in `src/app/theme.js`:

```js
import { createTheme } from '@mui/material/styles';

const theme = createTheme({
  palette: {
    mode: 'light',
    background: { default: '#f9f9f9' },
    primary: { main: '#0066cc' },
    error: { main: '#e63946' },
    info: { main: '#1d3557' },
    secondary: { main: '#457b9d' }
  },
  typography: {
    fontFamily: 'Inter, Roboto, Arial, sans-serif',
    h3: { fontWeight: 700 },
    h4: { fontWeight: 700 }
  }
});

export default theme;
```

---

## 4) Core Math (src/utils/math.js)

```js
const toRad = d => (d * Math.PI) / 180;
const toDeg = r => (r * 180) / Math.PI;

export function computeMitreBevel(Sdeg) {
  const C = 90;
  const S = toRad(Sdeg);
  const halfC = toRad(C / 2);

  const M = Math.atan(Math.sin(halfC) / Math.tan(S));
  const B = Math.asin(Math.cos(halfC) * Math.cos(S));

  const round1 = x => Math.round(x * 10) / 10;

  return { m: round1(toDeg(M)), b: round1(toDeg(B)) };
}
```

---

## 5) Acceptance Criteria

- ✅ Input range 0°–45°, live updates.
- ✅ Outputs M and B with 0.1° precision.
- ✅ Diagrams auto-update.
- ✅ PDF contains values + diagrams.
- ✅ Responsive layout with MUI Grid.
- ✅ Looks and performs well on mobile, tablet, desktop.

---

## ✅ Junie AI Build Tasks

- Use **React + MUI** (Vite SPA).
- Use **pnpm** for all installs.
- Generate files per **Folder Structure** above.
- Implement **ControlsPanel**, **ResultsCard**, **DiagramTabs**, **DiagramGeometry**, **DiagramSaw**, **PdfButton**.
- Wire math from `useCalculator` + `computeMitreBevel`.
- Ensure PDF downloads correctly and includes diagrams.
